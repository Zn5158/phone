import{k as e,s,r as i,o as t,c as a,w as l,a as o,b as d,t as n,l as c,h,m as r,e as u,I as k,g as p,p as v,q as m,F as f,d as g}from"./index.22aa5745.js";import{_ as C}from"./plugin-vue_export-helper.21dcd24c.js";import{r as x}from"./uni-app.es.03b1f0fa.js";var _=C({name:"login",data:()=>({webUrl:"https://test.dycharts.com/",codeText:"发送验证码",code:"",sending:!1,validPhone:!0,validCode:!0,phone:"",codeValue:"",validText:"您输入的手机号有误",validText2:"请输入验证码",isFirst:!0}),props:["isMask"],methods:{getCode(){e({url:this.webUrl+"vis/auth/send_signin_sms_code",method:"POST",data:{phoneNo:this.phone},withCredentials:!0,success:e=>{}})},sendCode(){if(!this.phone)return this.validPhone=!1,void(this.validText="请输入手机号");let e=/^1(3|4|5|6|7|8|9)\d{9}$/.test(this.phone);if(!e)return this.validPhone=e,void(this.validText="您输入的手机号有误");if(this.validPhone=e,!this.sending){this.getCode(),this.sending=!0,this.code=9,this.validCode=!0,this.codeText=this.code+"秒后可重新发送";let e=setInterval((()=>{this.code--,0==this.code?(clearInterval(e),this.codeText="重新发送",this.sending=!1):this.codeText=this.code+"秒后可重新发送"}),1e3)}},clickMask(){this.isFirst=!0,this.sending=!1,this.validPhone=!0,this.validCode=!0,this.isFirst=!0,this.$emit("clickMask",!1)},modalClick(){console.log("事件冒泡")},login(){if(this.isFirst=!1,!this.phone)return this.validPhone=!1,void(this.validText="请输入手机号");let e=/^1(3|4|5|6|7|8|9)\d{9}$/.test(this.phone);if(!e)return this.validPhone=e,void(this.validText="您输入的手机号有误");this.validPhone=e,this.codeValue?setTimeout((()=>{s({title:"失败",icon:"error",duration:2e3})}),3e3):this.validCode=!1},goOtherPage(){i({url:"/pages/webview/webview"})}}},[["render",function(e,s,i,m,f,g){const C=u,x=k,_=p,M=v;return i.isMask?(t(),a(C,{key:0,class:"mask",onClick:g.clickMask},{default:l((()=>[o(C,{class:"modal",onClick:r(g.modalClick,["stop"])},{default:l((()=>[o(C,{class:"tooltip-title"},{default:l((()=>[d("只需几秒即可登录/注册")])),_:1}),o(x,{class:"uni-input phone",type:"number",modelValue:f.phone,"onUpdate:modelValue":s[0]||(s[0]=e=>f.phone=e),placeholder:"请输入手机号"},null,8,["modelValue"]),o(C,{class:"error-text"},{default:l((()=>[f.validPhone?c("",!0):(t(),a(_,{key:0},{default:l((()=>[d(n(f.validText),1)])),_:1}))])),_:1}),o(C,{class:"password-container"},{default:l((()=>[o(_,{class:h(["valid-code-text",{gray:!f.sending}]),onClick:g.sendCode},{default:l((()=>[d(n(f.codeText),1)])),_:1},8,["class","onClick"]),o(x,{class:"uni-input password",password:"",type:"text",modelValue:f.codeValue,"onUpdate:modelValue":s[1]||(s[1]=e=>f.codeValue=e),placeholder:"手机验证码"},null,8,["modelValue"])])),_:1}),o(C,{class:"error-text"},{default:l((()=>[f.validCode?c("",!0):(t(),a(_,{key:0},{default:l((()=>[d(n(f.validText2),1)])),_:1}))])),_:1}),o(M,{type:"primary",class:"login-btn",onClick:g.login},{default:l((()=>[d("登录/注册")])),_:1},8,["onClick"]),o(C,{class:"login-msg"},{default:l((()=>[d("登录即同意"),o(_,{class:"blue",onClick:g.goOtherPage},{default:l((()=>[d("用户协议")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["onClick"])])),_:1},8,["onClick"])):c("",!0)}],["__scopeId","data-v-68878b75"]]);var M=C({data:()=>({isMask:!1}),methods:{closeMask(e){this.isMask=e},back(e){this.isMask=e}}},[["render",function(e,s,i,a,n,c){const h=v,r=x(g("login"),_);return t(),m(f,null,[o(h,{type:"primary",onClick:s[0]||(s[0]=e=>n.isMask=!0)},{default:l((()=>[d("登录/注册")])),_:1}),o(r,{isMask:n.isMask,onClickMask:c.closeMask,onBack:c.back},null,8,["isMask","onClickMask","onBack"])],64)}]]);export{M as default};
